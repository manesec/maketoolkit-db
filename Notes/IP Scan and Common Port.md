# IP Scan and common port

## Common Port from hacktricks

```
7,21,22,23,25,465,587,43,49,53,69,79,80,443,88,110,995,111,113,123,135,593,137,138,139,139,445,143,993,161,162,10161,10162,194,6667,6660,7000,2641,389,636,3268,3269,500,502,512,513,514,515,548,554,8554,623,631,700,873,1026,1080,1098,1099,1050,1414,1433,1521,1522,1529,1723,1883,2049,2301,2381,2375,2376,3128,3260,3299,3306,3389,3632,3690,3702,4369,4786,4840,5000,5353,5432,5433,5439,5555,5601,5671,5672,5800,5801,5900,5901,5984,6984,5985,5986,5985,5986,6011,6379,8009,8086,8089,8333,18333,38333,18444,9000,9001,9042,9160,9100,9200,10000,11211,15672,24007,24008,24009,49152,27017,27018,44134,44818,47808,50030,50060,50070,50075,50090

```
## Rustscan

```
.\rustscan -a 172.16.10.0/24 -g -p 7,21,22,23,25,465,587,43,49,53,69,79,80,443,88,110,995,111,113,123,135,593,137,138,139,139,445,143,993,161,162,10161,10162,194,6667,6660,7000,2641,389,636,3268,3269,500,502,512,513,514,515,548,554,8554,623,631,700,873,1026,1080,1098,1099,1050,1414,1433,1521,1522,1529,1723,1883,2049,2301,2381,2375,2376,3128,3260,3299,3306,3389,3632,3690,3702,4369,4786,4840,5000,5353,5432,5433,5439,5555,5601,5671,5672,5800,5801,5900,5901,5984,6984,5985,5986,5985,5986,6011,6379,8009,8086,8089,8333,18333,38333,18444,9000,9001,9042,9160,9100,9200,10000,11211,15672,24007,24008,24009,49152,27017,27018,44134,44818,47808,50030,50060,50070,50075,50090 
```

## Nmap Icmp scan

```
# Ping
$ nmap -sn 192.168.222.0/24 -vvv

# TCP ACK Ping
$ nmap -sn -PA 192.168.222.0/24 -vvv

# UDP Ping
$ sudo nmap -sn -PU 192.168.222.0/24 -vvv

```

## Ping Scan OneLine

``` bash
for x in {1..254} ;do ping -c 2 "172.16.1.$x" | grep "bytes from" | cut -d ':' -f 1 | cut -d ' ' -f 4 | sort | uniq  ; done;

for i in {1..254} ;do (ping -c 1 172.16.5.$i | grep "bytes from" &) ;done
```

```cmd
(for /L %a IN (1,1,254) DO ping /n 1 /w 1 172.16.2.%a) | find "Reply"

for /L %i in (1 1 254) do ping 172.16.5.%i -n 1 -w 100 | find "Reply"
```

```powershell
1..254 | % {"172.16.5.$($_): $(Test-Connection -count 1 -comp 172.15.5.$($_) -quiet)"}
```

## UDP Nmap

```

# SNMP
$ sudo nmap -vv -sU -p 161,162,10161,10162 <IP>


```